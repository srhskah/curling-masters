{% extends 'layout.html' %}
{% block content %}
  <!-- åˆ†é¡µå¯¼èˆª -->
  <div class="page-navigation">
    <button onclick="showPage('seasons')" class="page-btn active" id="btn-seasons">èµ›å­£</button>
    <button onclick="showPage('rankings')" class="page-btn" id="btn-rankings">æ€»ç§¯åˆ†æ’å</button>
    <button onclick="showPage('medals')" class="page-btn" id="btn-medals">å¥–ç‰Œæ¦œ</button>
  </div>

  <!-- èµ›å­£é¡µé¢ -->
  <div id="page-seasons" class="page-content">
    <!-- <h2>èµ›å­£</h2> -->
    <div class="seasons-grid">
    {% for s in seasons %}
        <div class="season-card">
          <a href="/season/{{ s.season_id }}">
            <h3>{{ s.year }}</h3>
            <p>ç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…</p>
          </a>
        </div>
      {% else %}
        <div style="grid-column: 1 / -1; text-align: center; color: #666; padding: 40px;">
          <p>æš‚æ— èµ›å­£æ•°æ®</p>
        </div>
      {% endfor %}
    </div>
  </div>

  <!-- æ€»ç§¯åˆ†æ’åé¡µé¢ -->
  <div id="page-rankings" class="page-content" style="display: none;">
    {% if player_rankings %}
      <div class="table-container" style="overflow-x: auto; margin: 20px 0;">
        <table class="ranking-table">
          <thead>
            <tr>
              <th>æ’å</th>
              <th>é€‰æ‰‹</th>
              <th>æ€»ç§¯åˆ†</th>
              <th>èµ·è®¡åˆ†</th>
              <th>å‚èµ›æ¬¡æ•°</th>
            </tr>
          </thead>
          <tbody>
            {% for player in player_rankings %}
              <tr>
                {% if player.rank == 1 %}
                  <td class="rank-1">{{ player.rank }}</td>
                {% elif player.rank == 2 %}
                  <td class="rank-2">{{ player.rank }}</td>
                {% elif player.rank == 3 %}
                  <td class="rank-3">{{ player.rank }}</td>
                {% else %}
                  <td>{{ player.rank }}</td>
                {% endif %}
                <td><a href="/player/{{ player.player_id }}">{{ player.name }}</a></td>
                <td style="font-weight: bold; color: #667eea;">{{ player.total_score }}</td>
                <td>{{ player.baseline_score }}</td>
                <td>{{ player.total_count }}</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    {% else %}
      <p style="text-align: center; color: #666; padding: 40px;">æš‚æ— æ’åæ•°æ®</p>
    {% endif %}
  </div>

  <!-- å¥–ç‰Œæ¦œé¡µé¢ -->
  <div id="page-medals" class="page-content" style="display: none;">
    <!-- <h2>å¥–ç‰Œæ¦œ</h2> -->
    
    <!-- å¥–ç‰Œæ¦œå¯¼èˆª -->
    <div class="medal-navigation" style="margin: 20px 0; text-align: center;">
      <button onclick="showMedalType('major')" class="page-btn active" id="btn-major-medals">å¤§èµ›å¥–ç‰Œæ¦œ</button>
      <button onclick="showMedalType('minor')" class="page-btn" id="btn-minor-medals">å°èµ›å¥–ç‰Œæ¦œ</button>
      <button onclick="showMedalType('final')" class="page-btn" id="btn-final-medals">æ€»å†³èµ›å¥–ç‰Œæ¦œ</button>
    </div>
    
    <!-- å¤§èµ›å¥–ç‰Œæ¦œ -->
    <div id="medal-major" class="medal-content">
      {% if major_medal_standings %}
        <!-- <h3>å¤§èµ›å¥–ç‰Œæ¦œ</h3> -->
        <div class="table-container" style="overflow-x: auto; margin: 20px 0;">
          <table class="medal-table">
            <thead>
              <tr>
                <th>æ’å</th>
                <th>é€‰æ‰‹</th>
                <th>ğŸ¥‡</th>
                <th>ğŸ¥ˆ</th>
                <th>ğŸ¥‰</th>
                <th>æ€»è®¡</th>
              </tr>
            </thead>
            <tbody>
              {% for player in major_medal_standings %}
                <tr>
                  <td>{{ loop.index }}</td>
                  <td><a href="/player/{{ player.player_id }}">{{ player.name }}</a></td>
                  <td class="gold">{{ player.gold }}</td>
                  <td class="silver">{{ player.silver }}</td>
                  <td class="bronze">{{ player.bronze }}</td>
                  <td class="total">{{ player.total }}</td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      {% else %}
        <p style="text-align: center; color: #666; padding: 40px;">æš‚æ— å¤§èµ›å¥–ç‰Œæ•°æ®</p>
      {% endif %}
    </div>
    
    <!-- å°èµ›å¥–ç‰Œæ¦œ -->
    <div id="medal-minor" class="medal-content" style="display: none;">
      {% if minor_medal_standings %}
        <!-- <h3>å°èµ›å¥–ç‰Œæ¦œ</h3> -->
        <div class="table-container" style="overflow-x: auto; margin: 20px 0;">
          <table class="medal-table">
            <thead>
              <tr>
                <th>æ’å</th>
                <th>é€‰æ‰‹</th>
                <th>ğŸ¥‡</th>
                <th>ğŸ¥ˆ</th>
                <th>ğŸ¥‰</th>
                <th>æ€»è®¡</th>
              </tr>
            </thead>
            <tbody>
              {% for player in minor_medal_standings %}
                <tr>
                  <td>{{ loop.index }}</td>
                  <td><a href="/player/{{ player.player_id }}">{{ player.name }}</a></td>
                  <td class="gold">{{ player.gold }}</td>
                  <td class="silver">{{ player.silver }}</td>
                  <td class="bronze">{{ player.bronze }}</td>
                  <td class="total">{{ player.total }}</td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
    {% else %}
        <p style="text-align: center; color: #666; padding: 40px;">æš‚æ— å°èµ›å¥–ç‰Œæ•°æ®</p>
      {% endif %}
    </div>
    
    <!-- æ€»å†³èµ›å¥–ç‰Œæ¦œ -->
    <div id="medal-final" class="medal-content" style="display: none;">
      {% if final_medal_standings %}
        <!-- <h3>æ€»å†³èµ›å¥–ç‰Œæ¦œ</h3> -->
        <div class="table-container" style="overflow-x: auto; margin: 20px 0;">
          <table class="medal-table">
            <thead>
              <tr>
                <th>æ’å</th>
                <th>é€‰æ‰‹</th>
                <th>ğŸ¥‡</th>
                <th>ğŸ¥ˆ</th>
                <th>ğŸ¥‰</th>
                <th>æ€»è®¡</th>
              </tr>
            </thead>
            <tbody>
              {% for player in final_medal_standings %}
                <tr>
                  <td>{{ loop.index }}</td>
                  <td><a href="/player/{{ player.player_id }}">{{ player.name }}</a></td>
                  <td class="gold">{{ player.gold }}</td>
                  <td class="silver">{{ player.silver }}</td>
                  <td class="bronze">{{ player.bronze }}</td>
                  <td class="total">{{ player.total }}</td>
                </tr>
    {% endfor %}
            </tbody>
          </table>
        </div>
      {% else %}
        <p style="text-align: center; color: #666; padding: 40px;">æš‚æ— æ€»å†³èµ›å¥–ç‰Œæ•°æ®</p>
      {% endif %}
    </div>
  </div>

  <script>
    function showMedalType(type) {
      // éšè—æ‰€æœ‰å¥–ç‰Œå†…å®¹
      const medalContents = document.querySelectorAll('.medal-content');
      medalContents.forEach(content => {
        content.style.display = 'none';
      });
      
      // ç§»é™¤æ‰€æœ‰æŒ‰é’®çš„activeç±»
      const buttons = document.querySelectorAll('.medal-navigation .page-btn');
      buttons.forEach(btn => {
        btn.classList.remove('active');
      });
      
      // æ˜¾ç¤ºé€‰ä¸­çš„å¥–ç‰Œå†…å®¹
      document.getElementById('medal-' + type).style.display = 'block';
      
      // æ¿€æ´»é€‰ä¸­çš„æŒ‰é’®
      document.getElementById('btn-' + type + '-medals').classList.add('active');
    }
  </script>
{% endblock %}
